import asyncio
import logging

from zmongo import ZMongo
from data_processing import SafeResult
from pathlib import Path
from dotenv import load_dotenv

# Import your ZMongoEmbedder class here
from zmongo_embedder import ZMongoEmbedder

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Ensure environment variables are loaded (for GEMINI_API_KEY and MongoDB connection)
load_dotenv(Path.home() / "resources" / ".env_local")


async def main():
    # Initialize the embedder with a collection name where embeddings can be stored
    embedder = ZMongoEmbedder(collection="test_embeddings")

    # Example sentence to embed
    sentence = "Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry.Artificial intelligence is transforming the legal industry."

    logger.info(f"Embedding sentence: {sentence}")
    embeddings = await embedder.embed_text(sentence)

    if embeddings:
        logger.info(f"Generated {len(embeddings)} embedding vector(s).")
        print(f"First vector (truncated): {embeddings[0][:10]} ...")
    else:
        logger.warning("No embeddings were generated.")


if __name__ == "__main__":
    asyncio.run(main())
